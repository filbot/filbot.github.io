<!DOCTYPE html>
<html lang="en-us">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <title>ADS-B Node Display | Filbot Blog</title>

    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">    
<meta name="viewport" content="width=device-width,minimum-scale=1">
<meta name="description" content="Optimizing LCD Updates on a Raspberry Pi for Real-Time Data">
<meta name="generator" content="Hugo 0.145.0">


  <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">


<link rel="stylesheet" href="/css/style.css">


  
    
    <link rel="stylesheet" href="http://localhost:1313/css/custom.css">
  


<link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon" />








  </head>

  <body>
    <nav class="navigation">
	
		<a href="/">Home</a>
	
	<a href="/posts">Archive</a>
	<a href="/tags">Tags</a>
	<a href="/about">About</a>

	

	
</nav>


    <main class="main">
      

<section id="single">
    <h1 class="title">ADS-B Node Display</h1>

    <div class="tip">
        <time datetime="2025-03-29 19:05:55 -0700 PDT">Mar 29, 2025</time>
        <span class="split">
          ·
        </span>
        <span>
          600 words
        </span>
        <span class="split">
          ·
        </span>
        <span>
          3 minute read
        </span>
    </div>

    
    


    <div class="content">
      <p>Optimizing LCD Updates on a Raspberry Pi for Real-Time Data</p>
<p><p class="markdown-image">
  <img src="/assets/adsb-node-display/chatgpt-drawing.png" alt="ads-b node drawing from ChatGPT"  />
</p></p>
<p>When working with an LCD display connected via I²C on a Raspberry Pi, you might notice that repeatedly clearing and redrawing the entire screen can cause flicker and put extra load on your I²C bus. In our project, we developed a Python script that shows key system statistics—such as CPU temperature, ADS‑B message rate, and system uptime—while using an optimized update strategy to minimize unnecessary writes.</p>
<p>What Does the Code Do?
Our Python script performs the following tasks:</p>
<p>Data Acquisition:
CPU Temperature: Reads the CPU temperature from /sys/class/thermal/thermal_zone0/temp and converts it to degrees Celsius.
System Uptime: Reads uptime from /proc/uptime and formats it as HH:MM:SS.
ADS‑B Messages: Retrieves the cumulative number of ADS‑B messages from a JSON file (generated by dump1090) to calculate the current message rate.
Differential LCD Updates:
Instead of clearing and rewriting the whole 20×4 LCD display every second, the script compares each character of the new display text with what is currently shown. Only characters that have changed are updated. This “differential update” approach reduces flicker and decreases I²C traffic.
User-Friendly Display:
The display is formatted into four rows with concise labels:
Row 0: “ADS-B:” showing the current message rate.
Row 1: “PEAK:” displaying the highest observed message rate.
Row 2: “CPU TEMP:” showing the current CPU temperature.
Row 3: “UPTIME:” displaying the system uptime.
How the Code Works
Data Acquisition Functions</p>
<p>get_cpu_temperature()
This function opens the system file that holds the CPU temperature, reads its content (in millidegrees), and converts it to a more readable Celsius format.
get_uptime()
By reading /proc/uptime, the script calculates how many seconds the system has been running and converts that value into hours, minutes, and seconds.
get_aircraft_messages()
The cumulative ADS‑B message count is stored in a JSON file (generated by dump1090). The function loads this file, extracts the total count, and converts it to an integer.
Differential Updating with update_row()</p>
<p>Rather than clearing the screen, the script saves the previous display content in a list. For each update cycle, it builds new strings for each row (formatted with left-aligned labels and right-aligned values). The update_row() function then loops over each character position (always iterating over 20 columns) and writes only the characters that differ from the previously displayed string. This method minimizes the amount of data sent over I²C, resulting in smoother, more efficient updates.</p>
<p><p class="markdown-image">
  <img src="/assets/adsb-node-display/code-snippet.png" alt="code snippet"  />
</p></p>
<p>Formatting the Display</p>
<p>The helper function format_line(label, value) calculates the remaining width on a 20-character line after placing the label. It then right-aligns the value within that space, ensuring a neat display where the label is always on the left and the value is flush right.</p>
<p>Putting It All Together
The main loop of the script does the following once every second:</p>
<p>It fetches the latest CPU temperature, uptime, and ADS‑B messages.
It calculates the current ADS‑B message rate (by comparing the current cumulative count with the previous count) and updates the peak rate if the current rate exceeds the previous maximum.
It formats the four lines with the updated data and calls the differential update function to redraw only what’s changed.
The script then sleeps for one second before repeating the cycle.
Final Thoughts
By combining efficient data acquisition with a differential update strategy, this script provides a smooth, flicker-free real-time display on a 20×4 LCD. This is especially useful in projects like ADS‑B monitoring, where timely and accurate system stats are essential.</p>
<p>This approach not only optimizes performance by reducing I²C traffic, but also ensures that only the necessary parts of the display are refreshed, giving you a cleaner and more professional output.</p>
    </div>

    
    
    

</section>


    </main>
    
    <footer id="footer">
    

    <div class="copyright">
    
       © Copyright 
       2025 
       
    
    </div>
</footer>


    
        
        <script src="http://localhost:1313/js/custom.js"></script>
    


  </body>
</html>
